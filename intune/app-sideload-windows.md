---
title: Загрузка неопубликованных приложений Windows и Windows Phone для Intune
description: Узнайте, как подписывать бизнес-приложения, чтобы использовать Intune для их развертывания.
keywords: ''
author: erikre
ms.author: erikre
manager: dougeby
ms.date: 09/06/2018
ms.topic: article
ms.prod: ''
ms.service: microsoft-intune
ms.technology: ''
ms.assetid: e44f1756-52e1-4ed5-bf7d-0e80363a8674
ms.custom: intune-classic
ms.openlocfilehash: 1c0c197536cb6d6b452ff5e3607ad1af2d5a4ca8
ms.sourcegitcommit: d047a692c798e1fb61ee43a487d6332bce344610
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/07/2018
ms.locfileid: "44058903"
---
# <a name="sign-line-of-business-apps-so-they-can-be-deployed-to-windows-devices-with-intune"></a>Подписывание бизнес-приложений для развертывания на устройствах Windows с помощью Intune

[!INCLUDE [both-portals](./includes/note-for-both-portals.md)]

Администратор Intune может развертывать бизнес-приложения (LOB), включая приложение корпоративного портала, на устройствах Windows и Windows 10 Mobile. Чтобы развертывать приложения APPX или XAP на устройствах Windows 10 или Windows 10 Mobile либо любое бизнес-приложение на устройствах Windows 8.1 или Windows Phone 8.1, необходимо получить **сертификат подписи мобильного кода Symantec Enterprise**. Только сертификат Symantec является доверенным для этих приложений соответствующих устройств Windows. Для приложений Windows 10 и "универсальных" приложений можно использовать собственный центр сертификации. Этот сертификат необходим для выполнения следующих задач:

-   подписывание приложения корпоративного портала для развертывания на компьютерах под управлением Windows, устройствах Windows 10 Mobile и Windows Phone;

-   подписывание бизнес-приложений компании, чтобы система Intune могла развернуть их на устройствах Windows.

Ниже приводятся процедуры получения необходимого сертификата и подписывания приложений. Вам необходимо зарегистрироваться в качестве разработчика Майкрософт и приобрести сертификат Symantec.


1. **Регистрация в качестве разработчика Майкрософт**<br>
   [Регистрация в качестве разработчика Майкрософт](http://go.microsoft.com/fwlink/?LinkId=268442) с использованием данных корпоративной учетной записи, которую вы использовали для входа при покупке учетной записи организации. Запрос должен быть утвержден должностным лицом организации, прежде чем вы сможете получить сертификат подписи кода.

2. **Получение сертификата Symantec для компании**<br>
  Приобретите сертификат на [веб-сайте Symantec](http://go.microsoft.com/fwlink/?LinkId=268441) , используя свой идентификатор Symantec. После покупки сертификата утверждающая организация, назначенная вами при регистрации в качестве разработчика Майкрософт, получит сообщение электронной почты с просьбой утвердить запрос сертификата. Дополнительные сведения о требованиях к сертификату Symantec см. в разделе [Почему для управления Windows Phone требуется сертификат Symantec?](https://technet.microsoft.com/library/dn764959.aspx#BKMK_Symantec). Регистрация устройств Windows. Часто задаваемые вопросы.

3.  **Импорт сертификатов**<br>
    После утверждения запроса вы получите сообщение электронной почты с инструкциями по импорту сертификатов. Следуйте инструкциям в сообщении, чтобы импортировать сертификаты.

4.  **Проверка импорта сертификатов**<br>
    Чтобы проверить, правильно ли импортированы сертификаты, перейдите в оснастку **Сертификаты**, щелкните пункт **Сертификаты** правой кнопкой мыши и выберите пункт **Поиск сертификатов**. В поле **Содержит** введите Symantec и нажмите кнопку **Найти**. Импортированные сертификаты должны появиться в списке результатов.

    ![Поиск сертификата Symantec](./media/wit.gif)

5. **Экспорт сертификата подписи**<br>
    Убедившись в наличии сертификатов, можно экспортировать ﻿﻿PFX-файл для подписывания корпоративного портала. Выберите сертификат Symantec с **целью выдачи** "подписывание кода". Щелкните сертификат подписи кода правой кнопкой мыши и выберите пункт **Экспортировать**.

    ![Экспорт сертификата для подписи](./media/wit-walk-cert2.gif)

    В окне **Мастер экспорта сертификатов**установите переключатель **Да, экспортировать закрытый ключ** и нажмите кнопку **Далее**. **Выберите файл обмена личной информацией –PKCS #12 (PFX)** и установите флажок **По возможности включать все сертификаты в путь сертификации**. Завершите работу мастера. Дополнительные сведения см. в статье [Экспорт сертификата с закрытым ключом](http://go.microsoft.com/fwlink/?LinkID=203031).

6.  **Отправка приложения в Intune**<br>
    Отправьте подписанный файл приложения и сертификат подписи кода, чтобы предоставить приложение конечным пользователям.

    1.  На портале Azure щелкните **Администрирование** &gt; **Windows Phone**.

    2.  Щелкните **Отправить подписанный файл приложения** и выполните вход с помощью вашего ИД администратора Intune.

    3.  Добавьте файл сертификата (PFX), экспортированный в **Сертификат подписывания кода**, и создайте пароль для сертификата.

    4.  Завершите работу мастера.

## <a name="example-download-sign-and-deploy-the-company-portal-app-for-windows-devices"></a>Пример. Скачивание, подписывание и развертывание приложения корпоративного портала для устройств Windows

Вы можете развернуть приложение корпоративного портала на устройствах Windows, включая Windows Phone и Windows 10 Mobile, с помощью Intune вместо того, чтобы устанавливать его из Магазина Майкрософт. Необходимо скачать приложение корпоративного портала и подписать его с помощью сертификата.  Это необходимо сделать, только если пользователи не будут использовать Магазин компании и если вы хотите развернуть портал компании на устройствах Windows Phone 8.1.


1.  **Скачайте портал компании**

    Чтобы развернуть приложение корпоративного портала с помощью Intune, скачайте [приложение корпоративного портала Microsoft Intune для Windows Phone 8.1](http://go.microsoft.com/fwlink/?LinkId=615799) из Центра загрузки и запустите самоизвлекающийся файл (EXE). Этот файл содержит два файла:

    -   CompanyPortal.appx — приложение установки портала компании для Windows Phone 8.1;

    -   WinPhoneCompanyPortal.ps1 — скрипт PowerShell, который можно использовать для подписи файла для приложения портала компании, чтобы его можно было развернуть на устройствах Windows Phone 8.1.

    Кроме того, корпоративный портал Windows Phone 8.1 (автономный лицензированный пакет) или корпоративный портал Windows 10 можно скачать из [Магазина Майкрософт для бизнеса](http://businessstore.microsoft.com/). Приложение корпоративного портала необходимо получить с помощью автономной лицензии и соответствующего пакета, скачанного для использования в режиме "вне сети". Списки платформ Windows 8 и Windows Phone 8 в выделенной области относятся к соответствующим аналогам 8.1. Дополнительные сведения о выполнении этой задачи в Intune см. в статье [Управление приложениями, которые вы приобрели в Магазине Майкрософт для бизнеса](/intune-classic/deploy-use/manage-apps-you-purchased-from-the-windows-store-for-business-with-microsoft-intune).

2.  **Скачивание пакета SDK для Windows Phone** Скачайте пакет SDK для Windows Phone версии 8.0] (http://go.microsoft.com/fwlink/?LinkId=615570)) и установите его на компьютере. Этот пакет SDK необходим для создания токена регистрации приложения.

3.  **Создание AETX-файла** Создайте файл токена регистрации приложения (AETX) из PFX-файла Symantec с помощью программы AETGenerator.exe, входящей в состав пакета SDK для Windows Phone версии 8.0. Инструкции по созданию AETX-файла см. в разделе [Создание токена регистрации приложения для Windows Phone](https://msdn.microsoft.com/library/windows/apps/jj735576.aspx).

4.  **Скачивание пакета SDK для Windows 8.1** Скачайте и установите [пакет SDK для Windows Phone](http://go.microsoft.com/fwlink/?LinkId=613525) (http://go.microsoft.com/fwlink/?LinkId=613525)). Обратите внимание, что скрипт PowerShell, входящий в состав приложения портала компании, использует расположение установки по умолчанию — `${env:ProgramFiles(x86)}\Windows Kits\8.1`. Если установка производится в другое расположение, необходимо включить его в параметр командлета.

5.  **Подписание кода приложения с помощью PowerShell** С правами администратора откройте **Windows PowerShell** на главном компьютере с пакетом SDK для Windows, затем корпоративный сертификат подписи кода мобильных устройств Symantec, перейдите к файлу Sign-WinPhoneCompanyPortal.ps1 и запустите скрипт.

    **Пример 1**

    ```
    .\Sign-WinPhoneCompanyPortal.ps1 -InputAppx 'C:\temp\CompanyPortal.appx' -OutputAppx 'C:\temp\CompanyPortalEnterpriseSigned.appx' -PfxFilePath 'C:\signing\cert.pfx' -PfxPassword '1234' -AetxPath 'C:\signing\cert.aetx'
    ```
    В этом примере подписывается файл CompanyPortal.appx в C:\temp\ и создается файл CompanyPortalEnterpriseSigned.appx. Он будет использовать пароль PFX 1234 и считывать идентификатор издателя из PFX-файла. Он также считывает идентификатор организации из файла cert.aetx.

    **Пример 2**

    ```
    .\Sign-WinPhoneCompanyPortal.ps1 -InputAppx 'C:\temp\CompanyPortal.appx' -OutputAppx 'C:\temp\CompanyPortalEnterpriseSigned.appx' -PfxFilePath 'C:\signing\cert.pfx' -PfxPassword '1234' -PublisherId 'OID.0.9.2342.19200300.100.1.1=1000000001, CN="Test, Inc.", OU=Test 1' -EnterpriseId 1000000001
    ```
    В этом примере подписывается файл CompanyPortal.appx в C:\temp\ и создается файл CompanyPortalEnterpriseSigned.appx. Он будет использовать пароль PFX 1234 и указанный идентификатор издателя.

    **Параметры:**

    -   `-InputAppx` — локальный путь к файлу CompanyPortal.appx в одинарных кавычках. Например, 'C:\temp\CompanyPortal.appx'.

    -   `-OutputAppx` — локальный путь и имя файла для подписанного приложения портала компании в одинарных кавычках. Например, 'C:\temp\CompanyPortalEnterpriseSigned.appx'.

    -   `-PfxFilePath` — локальный путь и имя экспортированного PFX-файла сертификата Symantec. Например, 'C:\signing\cert.pfx'.

    -   `-PfxPassword` — пароль, используемый для подписания PFX-файла, в одинарных кавычках. Например, '1234'.

    -   `-AetxPath` — локальный путь к AETX-файлу, который используется для считывания идентификатора организации, если аргумент EnterpriseId не задан. Необходимо указать либо этот аргумент, либо EnterpriseId. Например, 'C:\signing\cert.aetx'.

    -   `-PublisherId` — идентификатор издателя организации. Если он отсутствует, используется поле Subject (Тема) корпоративного сертификата подписи кода для мобильных устройств Symantec. Например, 'OID.0.9.2342.19200300.100.1.1=1000000001, CN="Test, Inc.", OU=Test 1'.

    -   `-SdkPath` — путь к корневой папке Windows SDK для Windows 8.1. Этот аргумент является необязательным и по умолчанию имеет значение ${env:ProgramFiles(x86)}\Windows Kits\8.1.

    -   `-EnterpriseId` — идентификатор организации. Необходимо указать либо этот аргумент, либо AetxPath. Если этот аргумент не задан, идентификатор организации считывается из AETX-файла. Например, 1000000001.

6.  Разверните приложение портала компании Windows Phone 8.1 (SSP.appx). См. инструкции в разделе [Как добавить бизнес-приложения Windows Phone в Microsoft Intune](lob-apps-windows-phone.md) ([классический портал](/intune-classic/deploy-use/deploy-apps-in-microsoft-intune)).

## <a name="how-to-renew-the-symantec-enterprise-code-signing-certificate"></a>Инструкции по обновлению корпоративного сертификата Symantec для подписи кода

Сертификат Symantec, используемый для развертывания мобильных приложений Windows и Windows Phone, должен периодически обновляться.

1.  Дождитесь сообщения электронной почты об обновлении, которое отправляет компания Symantec приблизительно за 14 дней до истечения срока действия сертификата. Это сообщение электронной почты содержит указания компании Symantec об обновлении корпоративного сертификата.

    Для получения дополнительных сведений о сертификатах Symantec посетите сайт [www.symantec.com](http://www.symantec.com) или позвоните по телефону +7 (495) 641-22-91 или +44 11 89-22-4660.

2.  Перейдите на веб-сайт (например, [https://products.websecurity.symantec.com/orders/enrollment/microsoftCert.do](https://products.websecurity.symantec.com/orders/enrollment/microsoftCert.do)) и выполните вход с помощью идентификатора издателя Symantec и адреса электронной почты, связанного с сертификатом. Не забудьте использовать тот же компьютер для запуска обновления, который будет использоваться для загрузки сертификата.

3.  После утверждения и оплаты обновления загрузите сертификат.

### <a name="how-to-install-the-updated-certificate-for-line-of-business-lob-apps"></a>Установка обновленного сертификата для бизнес-приложений

1.  Подпишите последнюю версию бизнес-приложения.

2.  На портале Azure перейдите в раздел **Администратор** &gt; **Управление мобильными устройствами** &gt; **Windows Phone** и щелкните **Отправить подписанное приложение**.

3.  Отправьте вновь подписанный корпоративный портал. Вам понадобятся вновь подписанный SSP.xap и новый PFX-файл, полученный от Symantec, или маркер регистрации приложения, который был создан с использованием этого нового PFX-файла.

4.  После завершения передачи удалите старую версию портала компании в рабочей области **Программное обеспечение**  .

5.  Подпишите все новые и обновленные корпоративные бизнес-приложения с помощью нового сертификата. Существующие приложения не требуется заново подписывать и развертывать.

## <a name="manually-deploy-windows-10-company-portal-app"></a>Развертывание приложения корпоративного портала для Windows 10 вручную
Приложение корпоративного портала для Windows 10 можно развернуть вручную напрямую из Intune, даже если служба Intune еще не интегрирована с Магазином Майкрософт для бизнеса.

 > [!NOTE]
 > В этом случае при появлении каждого обновления приложения его будет необходимо развертывать вручную.

1. Войдите в свою учетную запись в [Магазине Майкрософт для бизнеса](https://www.microsoft.com/business-store) и получите версию **автономной лицензии** для приложения корпоративного портала.  
2. После получения приложения выберите его на странице **Инвентаризация**.  
3. Выберите **Все устройства Windows 10** в разделе **Платформа**, затем соответствующую **архитектуру** и скачиваемый файл. Для этого приложения файл лицензии не требуется.
![Изображение всех устройств с Windows 10 и сведения о пакете с архитектурой X86 для скачивания](./media/Win10CP-all-devices.png)
4. Скачайте все пакеты в группе "Необходимые платформы". Это необходимо сделать для архитектур x86, x64 и ARM — всего 9 пакетов, как показано ниже.

![Изображение файлов зависимостей для скачивания ](./media/Win10CP-dependent-files.png)
5. Перед отправкой приложения корпоративного портала в Intune создайте папку (например, C:&#92;Company Portal) с пакетами и структурируйте их следующим образом.
   1. Поместите пакет корпоративного портала в папку C:\Company Portal. Создайте в этой папке подпапку "Dependencies" (Зависимости).  
   ![Изображение сохраненной папки "Dependencies" с APPXBUN-файлом](./media/Win10CP-Dependencies-save.png)
   2. Поместите девять пакетов зависимостей в папку "Dependencies".  
   Если пакеты зависимостей помещены в папку по-другому, Intune не сможет их распознать и отправить их при отправке пакетов, в результате чего произойдет следующая ошибка отправки.  
   ![Зависимость приложения Windows для этого установщика программного обеспечения не найдена в папке приложения. Процесс создания и развертывания этого приложения можно продолжить, но его запуск окажется возможен только при предоставлении отсутствующей зависимости приложения Windows.](./media/Win10CP-error-message.png)
6. Вернитесь в Intune и отправьте приложение корпоративного портала как новое приложение. Разверните его как обязательное приложение для требуемой группы целевых пользователей.  

Дополнительные сведения об обработке зависимостей для универсальных приложений в Intune см. в разделе [Развертывание appxbundle с зависимостями через Microsoft Intune MDM](https://blogs.technet.microsoft.com/configmgrdogs/2016/11/30/deploying-an-appxbundle-with-dependencies-via-microsoft-intune-mdm/).  

### <a name="how-do-i-update-the-company-portal-on-my-users-devices-if-they-have-already-installed-the-older-apps-from-the-store"></a>Как обновить корпоративный портал на устройствах моих пользователей, если они уже установили старые приложения из магазина?
Если пользователи уже установили из магазина приложения корпоративного портала для Windows 8.1 или Windows Phone 8.1, то у них должно быть автоматически выполнено обновление до новой версии (никаких дополнительных действий ни вам, ни вашим пользователям выполнять не нужно). Если обновление не происходит, попросите пользователей проверить, включена ли на их устройствах функция автоматического обновления для приложений из Магазина.   

### <a name="how-do-i-upgrade-my-sideloaded-windows-81-company-portal-app-to-the-windows-10-company-portal-app"></a>Как обновить мое загруженное неопубликованное приложение корпоративного портала для Windows 8.1 до приложения корпоративного портала для Windows 10?
Для миграции рекомендуем удалить развернутое приложение корпоративного портала для Windows 8.1. В этом случае выберите для действия развертывания значение "Удалить". После этого приложение корпоративного портала для Windows 10 можно будет развернуть с помощью любого из перечисленных выше способов.  

Если нужно загрузить неопубликованное приложение, и вы развернули корпоративный портал для Windows 8.1 без подписи с помощью сертификата Symantec, выполните для обновления процедуру развертывания непосредственно через Intune, описанную выше.

Если нужно загрузить неопубликованное приложение, и вы подписали и развернули корпоративный портал для Windows 8.1 с помощью сертификата подписи кода Symantec, выполните процедуру, описанную ниже.  

### <a name="how-do-i-upgrade-my-signed-and-sideloaded-windows-phone-81-company-portal-app-or-windows-81-company-portal-app-to-the-windows-10-company-portal-app"></a>Как обновить мое подписанное и загруженное неопубликованное приложение корпоративного портала для Windows Phone 8.1 или приложение корпоративного портала для Windows 8.1 до приложения корпоративного портала для Windows 10?
Для миграции рекомендуем удалить развернутое приложение корпоративного портала для Windows Phone 8.1 или Windows 8.1. В этом случае выберите для действия развертывания значение "Удалить". После этого приложение корпоративного портала для Windows 10 можно будет развернуть обычным образом.  

В противном случае приложение корпоративного портала для Windows 10 необходимо соответствующим образом обновить и подписать, чтобы соблюсти нужный путь обновления.  

Если приложение корпоративного портала для Windows 10 подписано и развернуто таким способом, эту процедуру необходимо будет повторить для каждого нового обновления приложения, когда оно появится в магазине. При обновлении в магазине приложения не будут обновляться автоматически.  

Ниже рассмотрена процедура подписания и развертывания приложения.

1. Скачайте скрипт подписывания приложения корпоративного портала для Microsoft Intune Windows 10 со страницы [https://aka.ms/win10cpscript](https://aka.ms/win10cpscript).  Для этого скрипта необходимо, чтобы на главном компьютере был установлен пакет Windows SDK для Windows 10. Чтобы скачать пакет SDK для Windows 10, посетите веб-сайт [https://go.microsoft.com/fwlink/?LinkId=619296](https://go.microsoft.com/fwlink/?LinkId=619296).
2. Скачайте приложение корпоративного портала для Windows 10 из Магазина Майкрософт для бизнеса, как описано выше.  
3. Запустите скрипт с входными параметрами, подробно описанными в заголовке скрипта, чтобы подписать приложение корпоративного портала для Windows 10 (см. пример ниже). Зависимости не обязательно передавать в скрипт. Они будут нужны только в том случае, если приложение отправляется в консоль администрирования Intune.

|       Параметр       |                                                                    Описание                                                                    |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| InputWin10AppxBundle  |                                             Путь к исходному файлу appxbundle.                                              |
| OutputWin10AppxBundle |                                                  Выходной путь для подписанного файла appxbundle.                                                  |
|       Win81Appx       |                          Путь к файлу (APPX) корпоративного портала для Windows 8.1 или Windows Phone 8.1.                           |
|      PfxFilePath      |                                   Путь к файлу (.PFX) корпоративного сертификата подписи кода для мобильных устройств Symantec.                                    |
|      PfxPassword      |                                     Пароль корпоративного сертификата подписи кода для мобильных устройств Symantec.                                      |
|      PublisherId      |      Идентификатор издателя организации. Если он отсутствует, используется поле Subject (Тема) корпоративного сертификата подписи кода для мобильных устройств Symantec.       |
|        SdkPath        | Путь к корневой папке пакета Windows SDK для Windows 10. Этот аргумент является необязательным и по умолчанию имеет значение ${env:ProgramFiles(x86)}\Windows Kits\10 |

По окончании работы скрипт создаст подписанную версию приложения корпоративного портала для Windows 10. Затем подписанную версию приложения можно будет развернуть как бизнес-приложение через Intune, что приведет к обновлению развернутых сейчас версий до этого нового приложения.  
