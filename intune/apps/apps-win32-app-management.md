---
title: Добавление и назначение приложений Win32 в Microsoft Intune
titleSuffix: ''
description: Узнайте, как добавлять, назначать и администрировать приложения Win32 в Microsoft Intune. В этой статье описано, как выполнять доставку и администрирование приложений Intune Win32, а также представлены сведения об устранении неполадок приложений Win32.
keywords: ''
author: Erikre
ms.author: erikre
manager: dougeby
ms.date: 01/21/2020
ms.topic: conceptual
ms.service: microsoft-intune
ms.subservice: apps
ms.localizationpriority: high
ms.technology: ''
ms.assetid: efdc196b-38f3-4678-ae16-cdec4303f8d2
ms.reviewer: mghadial
ms.suite: ems
search.appverid: MET150
ms.custom: intune-azure
ms.collection: M365-identity-device-management
ms.openlocfilehash: c120fab1da43230888866cba9d818d7b433b711e
ms.sourcegitcommit: 139853f8d6ea61786da7056cfb9024a6459abd70
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/26/2020
ms.locfileid: "76755295"
---
# <a name="intune-standalone---win32-app-management"></a>Изолированная среда Intune — управление приложениями Win32

Сейчас [автономная среда Intune](../fundamentals/mdm-authority-set.md) предоставляет улучшенные возможностей управления приложениями Win32. Хотя клиенты, подключенные к облаку, могут использовать Configuration Manager для управления приложениями Win32, пользователи только Intune будут иметь больше возможностей управления своими бизнес-приложениями Win32. В этой статье описана функция управления приложениями Win32 Intune и приведены сведения об устранении неполадок.

> [!NOTE]
> Эта функция поддерживает 32- и 64-разрядные архитектуры ОС для приложений Windows.

> [!IMPORTANT]
> При развертывании приложений Win32 рассмотрите возможность использования исключительно [справочника по расширению управления Intune](../apps/intune-management-extension.md), особенно если у вас есть многофайловый установщик приложений Win32. Если вы совместите установку приложений Win32 и бизнес-приложений во время регистрации AutoPilot, установка приложения может завершиться сбоем.  

## <a name="prerequisites"></a>Предварительные условия

Для использования функции управления приложениями Win32 необходимо выполнить следующие условия.

- Windows 10 Корпоративная версии 1607 или выше (Корпоративная, Профессиональная и для образовательных учреждений)
- Клиент Windows 10 должен быть: 
  - устройства должны быть присоединены к AAD и автоматически зарегистрированы. Расширение управления Intune поддерживает устройства, присоединенные к Azure AD, гибридному домену, а также зарегистрированные для поддержки групповой политики. 
  > [!NOTE]
  > В случаях, когда устройство зарегистрировано для поддержки групповой политики, конечный пользователь использует локальную учетную запись для присоединения устройства Windows 10 к AAD. Пользователь должен войти на устройство с помощью свей учетной записи AAD и зарегистрироваться в Intune. Если скрипт PowerShell или приложение Win32 предназначены для пользователя или устройства, Intune установит на устройстве расширение управления Intune.
- Размер приложения Windows не может превышать 8 ГБ.

## <a name="prepare-the-win32-app-content-for-upload"></a>Подготовка к отправке содержимого приложения Win32

Для предварительной обработки классических приложений Windows (Win32) используйте [средство подготовки файлов Win32 (Майкрософт)](https://go.microsoft.com/fwlink/?linkid=2065730). Это средство преобразует файлы установки приложения в формат *.intunewin*. Оно также обнаруживает некоторые атрибуты, необходимые Intune для определения состояния установки приложения. После его использования в папке установщика приложения вы сможете создать приложение Win32 в консоли Intune.

> [!IMPORTANT]
> [Средство подготовки файлов Win32 (Майкрософт)](https://go.microsoft.com/fwlink/?linkid=2065730) упакует все файлы и вложенные папки при создании файла *INTUNEWIN*. Средство подготовки файлов Win32 (Майкрософт) должно быть сохранено отдельно от файлов и папок установщика. В этом случае вы не сможете включить его или другие ненужные файлы и папки в файл *INTUNEWIN*.

[Средство подготовки файлов Win32 (Майкрософт)](https://go.microsoft.com/fwlink/?linkid=2065730) можно скачать с GitHub. ZIP-файл содержит папку **Microsoft-Win32-Content-Prep-Tool-master**. В папке находится средство подготовки, лицензия, файл сведений и заметки о выпуске. 

### <a name="process-flow-to-create-intunewin-file"></a>Последовательность действий по созданию файла INTUNEWIN

   <img alt="Process flow to create a .intunewin file" src="./media/apps-win32-app-management/prepare-win32-app.svg" width="700">

### <a name="run-the-microsoft-win32-content-prep-tool"></a>Запуск средства подготовки файлов Win32 (Майкрософт)

Если вы запускаете `IntuneWinAppUtil.exe` из командного окна без параметров, средство поможет вам последовательно задать необходимые параметры. Или можно добавить в команду указанные далее доступные параметры командной строки.

### <a name="available-command-line-parameters"></a>Возможные параметры командной строки 

|    **Параметр командной строки**    |    **Описание**    |
|:------------------------------:|:----------------------------------------------------------:|
|    `-h`     |    Справка    |
|    `-c <setup_folder>`     |    Папка для всех файлов установки. Все файлы в этой папке будут сжаты в файл *INTUNEWIN*.    |
|    `-s <setup_file>`     |    Файл установки (такой как *setup.exe* или *setup.msi*).    |
|    `-o <output_folder>`     |    Выходная папка для создаваемого файла с расширением *.intunewin*.    |
|    `-q`       |    Тихий режим    |

### <a name="example-commands"></a>Примеры команд

|    **Пример команды**    |    **Описание**    |
|:-----------------------------------------------------------------------------------------:|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|
|    `IntuneWinAppUtil -h`    |    Эта команда отображает информацию об инструменте.    |
|    `IntuneWinAppUtil -c c:\testapp\v1.0 -s c:\testapp\v1.0\setup.exe -o c:\testappoutput\v1.0 -q`    |    Эта команда создает файл `.intunewin` из указанной исходной папки и файла установки. Для MSI-файла установки этот инструмент будет извлекать сведения, необходимые для Intune. Если указан параметр `-q`, команда выполняется в тихом режиме; если выходной файл уже существует, он будет перезаписан. Кроме того, если выходная папка не существует, она будет создана автоматически.    |

Создавая файл *INTUNEWIN*, поместите все файлы, на которые создается ссылка, во вложенную папку в папке установки. Затем используйте относительный путь для создания ссылки на требуемый файл. Пример.

**Исходная папка установки:** *c:\testapp\v1.0*<br>
**Файл лицензии:** *c:\testapp\v1.0\licenses\license.txt*

Создайте ссылку на файл *license.txt*, используя относительный путь *licenses\license.txt*.

## <a name="create-assign-and-monitor-a-win32-app"></a>Создание, назначение и мониторинг приложения Win32

Подобно бизнес-приложениям (LOB), можно добавить приложение Win32 в Microsoft Intune. Приложения такого типа обычно создаются самостоятельно или сторонними разработчиками. 

### <a name="process-flow-to-add-a-win32-app-to-intune"></a>Последовательность действий по добавлению приложения Win32 в Intune

<img alt="Process flow to add a Win32 app to Intune" src="./media/apps-win32-app-management/add-win32-app.svg" width="500">

### <a name="add-a-win32-app-to-intune"></a>Добавление приложения Win32 в Intune

Ниже приведены инструкции, которые помогут вам добавить приложение Windows в Intune.

1. Войдите в [центр администрирования диспетчера конечных точек (Майкрософт)](https://go.microsoft.com/fwlink/?linkid=2109431).
2. Выберите **Приложения** > **Все приложения** > **Добавить**.
3. В области **Выбор типа приложения** в разделе **Другие** типов приложений выберите **Приложение Windows (Win32)** .

    > [!IMPORTANT]
    > Используйте последнюю версию средства подготовки файлов Win32 корпорации Майкрософт. В противном случае появится предупреждение о том, что приложение было упаковано с помощью более старой версии средства подготовки файлов Win32 корпорации Майкрософт. 

4. Щелкните **Выбрать**. Отобразятся шаги для **добавления приложения**.

## <a name="step-1---app-information"></a>Этап 1. Сведения о приложении

### <a name="select-the-app-package-file"></a>Выбор файла пакета приложения

1. На панели **Добавить приложение** щелкните **Выберите файл пакета приложения**. 
2. В области **Файл пакета приложения** нажмите кнопку обзора. Затем выберите файл установки Windows с расширением *.intunewin*.
   Отобразятся сведения о приложении.
3. По завершении выберите **ОК** на панели **Файл пакета приложения**.

### <a name="set-app-information"></a>Задание сведений о приложении

1. На странице **Сведения о приложении** добавьте сведения о приложении. В зависимости от выбранного приложения, некоторые значения в этой области могут заполняться автоматически.
    - **Имя** — Введите имя приложения так, как оно будет отображаться на корпоративном портале. Убедитесь, что все имена приложений являются уникальными. Если у двух приложений будет одно и то же имя, пользователи корпоративного портала увидят только одно из этих приложений.
    - **Описание**. Введите описание приложения. Описание отображается на корпоративном портале.
    - **Издатель** — Введите имя издателя приложения.
    - **Категория** — Выберите одну или несколько встроенных категорий приложений или созданную категорию. Категории облегчают поиск приложения при просмотре пользователями корпоративного портала.
    - **Отображение этого приложения как рекомендуемого на Корпоративном портале**. Отображать приложение на видном месте главной страницы корпоративного портала при просмотре приложений пользователями.
    - **URL-адрес сведений**. Дополнительно можно ввести URL-адрес веб-сайта со сведениями об этом приложении. URL-адрес отображается на корпоративном портале.
    - **URL-адрес политики конфиденциальности**. Дополнительно можно ввести URL-адрес веб-сайта со сведениями о политике конфиденциальности для этого приложения. URL-адрес отображается на корпоративном портале.
    - **Разработчик**. При необходимости введите имя разработчика приложения.
    - **Имя владельца**. При необходимости введите имя владельца приложения. Например, **Отдел кадров**.
    - **Заметки**. Введите любые заметки, которые нужно связать с этим приложением.
    - **Логотип**. Загрузите значок, который будет связан с приложением. Этот значок будет отображаться с приложением при просмотре пользователями корпоративного портала.
2. Нажмите кнопку **Далее**, чтобы отобразить страницу **Программа**.

## <a name="step-2-program"></a>Шаг 2. Программа

1. На странице **Программа** настройте команды установки и удаления приложения:
    - **Команда установки**. Добавьте полную строку команды установки для установки приложения. 

        Например, если имя файла приложения — **MyApp123**, добавьте следующее:<br>
        `msiexec /p “MyApp123.msp”`<p>
        Если приложением является `ApplicationName.exe`, в команде будет указано имя приложения, за которым следуют аргументы командной строки (параметры), поддерживаемые пакетом. <br>Пример.<br>
        `ApplicationName.exe /quiet`<br>
        В приведенной выше команде пакет `ApplicationName.exe` поддерживает аргумент команды `/quiet`.<p> 
        Чтобы узнать, какие аргументы поддерживает пакет приложения, обратитесь к поставщику приложения.

    - **Команда удаления**. Добавьте полную строку команды удаления для удаления приложения на основе его идентификатора GUID. 

        Например: `msiexec /x “{12345A67-89B0-1234-5678-000001000000}”`

    - **Install behavior** (Способ установки). Для параметра способа установки укажите значение **Система** или **Пользователь**.

        > [!NOTE]
        > Приложения Win32 можно настроить для установки в контексте **пользователя** или **системы**. Контекст **пользователя** связан только с данным конкретным пользователем. Контекст **системы** относится ко всем пользователям устройства Windows 10.
        >
        > Конечным пользователям не требуется выполнять вход на устройство для установки приложений Win32.
        > 
        > Установка и удаление приложений Win32 будет выполняться с правами администратора (по умолчанию), если для приложения настроена установка в контексте пользователя, а пользователь на устройстве имеет права администратора.
    
    - **Действие при перезагрузке устройства**. Выберите один из следующих параметров:
        - **Определять режим по кодам возврата**. Выберите этот параметр, чтобы перезапускать устройство по кодам возврата.
        - **Никаких действий выполняться не будет**. Выберите этот вариант, чтобы подавить перезапуск устройства во время установки приложения с помощью установщика Windows (MSI).
        - **Установка приложения может привести к перезапуску устройства**. Выберите этот вариант, чтобы разрешить завершение установки приложения без подавления перезапусков.
        - **Intune выполнит принудительную перезагрузку устройства**. Выберите этот вариант, чтобы всегда перезапускать устройство после успешной установки приложения.

    - **Задайте коды возврата, чтобы указать действия после установки**. Добавьте коды возврата, используемые для указания поведения при повторных попытках установки приложения или поведения после установки. Записи кодов возврата добавляются по умолчанию при создании приложения. Однако вы можете добавить дополнительные коды возврата или изменить существующие.
        1. В столбце **Тип кода** задайте для значения **Тип кода** один из следующих вариантов:
            - **Failed** (Сбой) — возвращаемое значение, указывающее на сбой при установке приложения.
            - **Hard reboot** (Жесткая перезагрузка) — код возврата жесткой перезагрузки не разрешает установку на клиенте следующих приложений Win32 без перезагрузки. 
            - **Soft reboot** (Мягкая перезагрузка) — код возврата мягкой перезагрузки разрешает установку следующих приложений Win32 без перезагрузки клиента. Перезагрузка необходима для завершения установки текущего приложения.
            - **Retry** (Повтор) — код возврата повтора означает, что будут выполняться три попытки установки приложения. Ожидание между попытками будет длиться 5 минут. 
            - **Success** (Успех) — этот код возврата указывает, что приложение было успешно установлено.
        2. При необходимости щелкните **Добавить**, чтобы добавить дополнительные коды возврата или изменить имеющиеся.
2. Нажмите кнопку **Далее**, чтобы отобразить страницу **Требования**.        

## <a name="step-3-requirements"></a>Шаг 3. Requirements (Требования)

1. На странице **Требования** укажите требования, которым должны соответствовать устройства перед установкой приложения:
    - **Архитектура операционной системы**. Выберите архитектуры, необходимые для установки приложения.
    - **Минимальная версия операционной системы**. Выберите минимальную версию операционной системы, необходимую для установки приложения.
    - **Требуемое дисковое пространство (МБ)** . При необходимости укажите свободное дисковое пространство, требуемое для установки приложения.
    - **Требуемая физическая память (МБ)** . При необходимости укажите объем физической памяти (ОЗУ), необходимый для установки приложения.
    - **Требуемое минимальное число логических процессоров**. При необходимости укажите минимальное число логических процессоров, требуемое для установки приложения.
    - **Требуемая минимальная скорость ЦП (МГц)** . При необходимости укажите минимальную скорость ЦП, требуемую для установки приложения.
    - **Настройка дополнительных правил требований**: 
        1. Нажмите кнопку **Добавить**, чтобы отобразить панель **Добавление правила требований** и настроить дополнительные правила требований. Щелкните **Тип требования** для выбора типа правила, используемого для определения способа проверки требования. Правила требований могут быть основаны на сведениях о файловой системе, значениях реестра или скриптах PowerShell. 
            - **Файл**. Если в качестве значения параметра **Тип требования** выбрано **Файл**, правило требований должно обнаруживать файл или папку, дату, версию или размер. 
                - **Путь** — полный путь к папке, содержащей файл или папку для обнаружения.
                - **Файл или папка** — файл или папка для обнаружения.
                - **Свойство** — выберите тип правила, используемый для проверки наличия приложения.
                - **Связан с 32-разрядным приложением на 64-разрядных клиентах** — выберите **Да** для развертывания переменных среды path в 32-разрядном контексте на 64-разрядных клиентах. Выберите **Нет** (по умолчанию) для развертывания переменных path в 64-разрядном контексте на 64-разрядных клиентах. 32-разрядные клиенты всегда будут использовать 32-разрядный контекст.
            - **Реестр**. Если в качестве значения параметра **Тип требования** выбрано **Реестр**, правило требований должно обнаруживать параметр реестра на основе значения, строки, целого числа или версии.
                - **Путь к разделу** — полный путь к записи реестра, содержащей значение для обнаружения.
                - **Имя значения** — имя значения реестра для обнаружения. Если это значение не указано, обнаружение будет выполняться в разделе. В качестве значения для обнаружения будет использоваться значение по умолчанию раздела, если выбран метод обнаружения, отличный от существования файла или папки.
                - **Требование раздела реестра** — выберите тип сравнения разделов реестра, используемый для определения способа проверки правила требований.
                - **Связан с 32-разрядным приложением на 64-разрядных клиентах** — выберите **Да** для поиска в 32-разрядном реестре на 64-разрядных клиентах. Выберите **Нет** (по умолчанию) для списка в 64-разрядном реестре на 64-разрядных клиентах. На 32-разрядных клиентах поиск всегда выполняется в 32-разрядном реестре.
            - **Скрипт**. Выберите **Скрипт** в качестве значения параметра **Тип требования**, если вам не удается создать правило требований на основе файла, реестра или любого другого метода, доступного в консоли Intune.
                - **Файл скрипта** — для правила требований на основе скрипта PowerShell: если код выхода равен 0, STDOUT будет определяться более подробно. Например, STDOUT может содержать целое число со значением 1.
                - **Запуск скрипта как 32-разрядного процесса на 64-разрядных клиентах** — выберите **Да** для запуска скрипта в 32-разрядных процессах на 64-разрядных клиентах. Выберите **Нет** (по умолчанию), чтобы запустить скрипт в 64-разрядном процессе на 64-разрядных клиентах. 32-разрядные клиенты запускают скрипт в 32-разрядном процессе.
                - **Запускать сценарий по учетным данным**. Выберите **Да** для запуска скрипта с помощью учетных данных устройства, с которого выполнен вход**.
                - **Применять проверку подписи скрипта** — выберите **Да** для проверки, подписан ли скрипт доверенным издателем. Такая подпись позволяет выполнение скрипта без отображения предупреждений и запросов. Скрипт будет выполняться разблокированным. Выберите **Нет** (по умолчанию), чтобы скрипт выполнялся с подтверждением пользователя без проверки подписи.
                - **Выберите тип выходных данных**. Выберите тип данных, используемый при определении совпадения правила требований.
        2. Завершив настройку правил требований, нажмите кнопку **ОК**.
2. Нажмите кнопку **Далее**, чтобы отобразить страницу **Правила обнаружения**.   

### <a name="step-4-detection-rules"></a>Шаг 4. Правила обнаружения

1. На странице **Правила обнаружения** настройте правила для обнаружения присутствия приложения:
    
    **Формат правил**. Выберите, как будет обнаруживаться присутствие приложения. Вы можете вручную настроить правила обнаружения или использовать настраиваемый скрипт для обнаружения присутствия приложения. Необходимо выбрать хотя бы одно правило обнаружения. 

    > [!NOTE]
    > В панели **Правила обнаружения** можно добавить несколько правил. Для обнаружения приложения должны быть выполнены **все** правила.
    >
    > Если служба Intune обнаружит, что приложение отсутствует на устройстве, она снова предложит это приложение через 24 часа. Это будет происходить только для приложений с требуемым намерением.

    - **Вручную настроить правила обнаружения**. Можно выбрать один из следующих типов правил.
        1. **MSI** — проверка на основе проверки версии MSI. Этот тип правила можно добавить только один раз. При выборе этого типа правила имеются два параметра.
            - **Код продукта MSI** — добавьте допустимый код продукта MSI для приложения.
            - **Проверка версии продукта MSI** — выберите **Да**, чтобы в дополнение к коду продукта MSI проверялась и версия продукта MSI.
        2. **Файл** — проверка на основе обнаружения файла или папки по дате, версии или размеру.
            - **Путь** — полный путь к папке, содержащей файл или папку для обнаружения.
            - **Файл или папка** — файл или папка для обнаружения.
            - **Метод обнаружения** — выберите тип метода обнаружения, используемого для проверки наличия приложения.
            - **Связан с 32-разрядным приложением на 64-разрядных клиентах** — выберите **Да** для развертывания переменных среды path в 32-разрядном контексте на 64-разрядных клиентах. Выберите **Нет** (по умолчанию) для развертывания переменных path в 64-разрядном контексте на 64-разрядных клиентах. 32-разрядные клиенты всегда будут использовать 32-разрядный контекст.
            
            **Примеры обнаружения на основе файла**
            1. Проверка существования файла.
         
                ![Снимок экрана панели правила обнаружения — существование файла](./media/apps-win32-app-management/apps-win32-app-03.png)
        
            2. Проверка существования папки.
         
                ![Снимок экрана панели правила обнаружения — существование папки](./media/apps-win32-app-management/apps-win32-app-04.png)
        
        3. **Реестр** — проверка на основе значения, строки, целого числа или версии.
            - **Путь к разделу** — полный путь к записи реестра, содержащей значение для обнаружения.
            - **Имя значения** — имя значения реестра для обнаружения. Если это значение не указано, обнаружение будет выполняться в разделе. В качестве значения для обнаружения будет использоваться значение по умолчанию раздела, если выбран метод обнаружения, отличный от существования файла или папки.
            - **Метод обнаружения** — выберите тип метода обнаружения, используемого для проверки наличия приложения.
            - **Связан с 32-разрядным приложением на 64-разрядных клиентах** — выберите **Да** для поиска в 32-разрядном реестре на 64-разрядных клиентах. Выберите **Нет** (по умолчанию) для списка в 64-разрядном реестре на 64-разрядных клиентах. На 32-разрядных клиентах поиск всегда выполняется в 32-разрядном реестре.
            
            **Примеры обнаружения на основе реестра**
            1. Проверка существования раздела реестра.
            
                ![Снимок экрана панели правила обнаружения — существование раздела реестра](./media/apps-win32-app-management/apps-win32-app-05.png)    
            
            2. Проверьте, существует ли значение реестра.
        
                ![Снимок экрана панели правила обнаружения — существование значения реестра](./media/apps-win32-app-management/apps-win32-app-06.png)    
        
            3. Проверка на равенство строки значения реестра.
        
                ![Снимок экрана панели правила обнаружения — равенство строки значения реестра](./media/apps-win32-app-management/apps-win32-app-07.png)    
     
    - **Использование настраиваемого скрипта обнаружения** — укажите скрипт PowerShell, который будет использоваться для обнаружения этого приложения. 
    
       1. **Файл скрипта** — выберите скрипт PowerShell, который будет обнаруживать наличие приложения на клиенте. Приложение будет обнаружено, когда скрипт возвратит код выхода со значением 0 и запишет строковое значение в STDOUT.

       2. **Запуск скрипта как 32-разрядного процесса на 64-разрядных клиентах** — выберите **Да** для запуска скрипта в 32-разрядных процессах на 64-разрядных клиентах. Выберите **Нет** (по умолчанию), чтобы запустить скрипт в 64-разрядном процессе на 64-разрядных клиентах. 32-разрядные клиенты запускают скрипт в 32-разрядном процессе.

       3. **Применять проверку подписи скрипта** — выберите **Да** для проверки, подписан ли скрипт доверенным издателем. Такая подпись позволяет выполнение скрипта без отображения предупреждений и запросов. Скрипт будет выполняться разблокированным. Выберите **Нет** (по умолчанию), чтобы скрипт выполнялся с подтверждением пользователя без проверки подписи.
    
            Агент Intune проверяет результаты скрипта. Он также считывает значения, записанные сценарием в стандартный поток вывода (STDOUT), стандартный поток ошибок (STDERR) и код выхода. Если скрипт на выходе возвращает ненулевое значение, значит, он завершился неудачно и состояние обнаружения приложения неизвестно. Если код выхода равен нулю и STDOUT содержит данные, состояние обнаружения приложения имеет значение "Установлено". 

            > [!NOTE]
            > Корпорация Майкрософт рекомендует использовать для скрипта кодировку UTF-8. Если скрипт на выходе возвращает значение 0, то он выполнился успешно. Второй выходной канал указывает, что приложение обнаружено — данные STDOUT показывают, что приложение было найдено на клиенте. Мы не ищем конкретную строку в STDOUT.

2. После добавления правил выберите **Далее**, чтобы отобразить страницу **Зависимости**.

### <a name="step-5-dependencies"></a>Шаг 5. Зависимости

Зависимости приложения — это приложения, которые должны быть установлены перед установкой приложения Win32. Можно указать, что другие приложения устанавливаются как зависимости. В частности, зависимые приложения необходимо установить на устройстве перед установкой приложения Win32. Можно использовать не более 100 зависимостей, включая зависимости включенных зависимостей и самого приложения. Зависимости приложения Win32 следует добавлять только после добавления и отправки приложения Win32 в Intune. После добавления приложения Win32 вы увидите параметр **Зависимости** на панели приложения Win32. 

Все зависимости приложений Win32 должны быть также приложением Win32. Зависимость от других типов приложений, таких как одиночные бизнес-приложения MSI или приложения Магазина, не поддерживается.

При добавлении зависимости приложения можно выполнить поиск по имени приложения и издателю. Кроме того, можно отсортировать зависимости по имени приложения и издателю. Ранее добавленные зависимости приложения нельзя выбрать в списке добавленных зависимостей. 

Вы можете указать, следует ли автоматически устанавливать каждое зависимое приложение. По умолчанию параметру **Автоматическая установка** задано значение **Да** для каждой зависимости. Intune автоматически установит зависимое приложение, даже если оно не предназначено для пользователя или устройства, в соответствии с условием зависимости перед установкой приложения Win32. Важно отметить, что зависимость может иметь рекурсивные дополнительные зависимости, и каждая такая зависимость будет устанавливаться перед установкой основной зависимости. Кроме того, при установке зависимостей не соблюдается порядок установки на заданном уровне зависимости.

### <a name="select-the-dependencies"></a>Выбор зависимостей

На странице **Зависимости** выберите приложения, которые необходимо установить перед установкой приложения Win32:
1. Щелкните **Добавить**, чтобы отобразить область **Добавить зависимости**.
3. Добавив зависимые приложения, нажмите **Выбрать**.
4. Решите, следует ли устанавливать зависимое приложение автоматически, выбрав **Да** или **Нет** в столбце **Автоматическая установка**.
5. Нажмите кнопку **Далее**, чтобы отобразить страницу **Теги области**.

### <a name="understand-additional-dependency-details"></a>Общие сведения о дополнительных зависимостях

Конечный пользователь увидит всплывающие уведомления Windows, информирующие о скачивании и установке зависимых приложений в ходе процесса установки приложения Win32. Кроме того, если зависимое приложение не установлено, будет выведено одно из следующих уведомлений:
- Установить некоторые зависимые приложения не удалось.
- Некоторые требования зависимых приложений не выполнены.
- Некоторые зависимые приложения ожидают перезагрузки устройства.

Если вы решили не выполнять **автоматическую установку** зависимости, попытка установки приложения Win32 предпринята не будет. В отчете по приложению будет указано, что зависимость была помечена как `failed`, и приведена причина сбоя. Чтобы просмотреть сведения об ошибке установки зависимости, щелкните соответствующую ссылку (или предупреждение) в колонке [Сведения об установке](troubleshoot-app-install.md#win32-app-installation-troubleshooting) для приложения Win 32. 

Каждая зависимость будет соответствовать логике повторных попыток приложения Win32 в Intune (попробуйте установить приложение 3 раза после ожидания в течение 5 минут) и глобальному расписанию повторной оценки. Кроме того, зависимости применяются только во время установки приложения Win32 на устройстве. Зависимости не применяются для удаления приложения Win32. Чтобы удалить зависимость, щелкните многоточие (три точки) слева от зависимого приложения, находящегося в конце строки списка зависимостей. 

## <a name="step-6---select-scope-tags-optional"></a>Этап 6. Выбор тегов области (необязательно)
Используя теги области в Intune, вы можете определить, кто может просматривать сведения о клиентском приложении. Полные сведения о тегах области см. в статье [Use role-based access control (RBAC) and scope tags for distributed IT](../fundamentals/scope-tags.md) (Использование управления доступом на основе ролей (RBAC) и тегов области для распределенной ИТ-разработки).

1. Щелкните **Выберите теги области**, чтобы дополнительно добавить теги области для приложения. 
2. Нажмите кнопку **Далее**, чтобы перейти на страницу **Назначения**.

## <a name="step-7---assignments"></a>Этап 7. Назначения

Выберите **Обязательные**, **Доступно для зарегистрированных устройств** или **Удаление** назначений группы для набора приложений. Дополнительные сведения см. в статьях [Добавление групп для организации пользователей и устройств](~/fundamentals/groups-add.md) и [Назначение приложений группам с помощью Microsoft Intune](apps-deploy.md).

1. Выберите тип назначения для конкретного приложения:
    - **Обязательное**. Приложение устанавливается на устройствах в выбранных группах.
    - **Available for enrolled devices** (Доступно для зарегистрированных устройств). Пользователи устанавливают приложение с приложения Корпоративного портала или веб-сайта Корпоративного портала.
    - **Удалить**. Приложение удаляется из устройств в выбранных группах.
2. Щелкните **Добавить группу** и назначьте группы, которые будут использовать это приложение.
3. На панели **Выбор групп** выберите назначение на основе пользователей или устройств. 
4. После выбора групп можно также задать **Уведомления для пользователей**, **Доступность** и **Крайний срок установки**. Дополнительные сведения см. в разделе [Настройка доступности и уведомлений для приложений Win32](~/apps/apps-win32-app-management.md#set-win32-app-availability-and-notifications).
5. Если вы хотите, чтобы группы пользователей не были затронуты этим назначением приложения, выберите **Включен** в столбце **Режим**. Откроется панель **Изменение назначения**. Для параметра **Режим** можно изменить значение с **Включен** на **Исключен**. Нажмите кнопку **ОК**, чтобы закрыть панель **Изменение назначения**.
6. Завершив настройку назначений для приложений, нажмите кнопку **Далее**, чтобы отобразить страницу **Проверка и создание**.

## <a name="step-8---review--create"></a>Этап 8. Проверка и создание

1. Проверьте значения и параметры, введенные для приложения. Убедитесь, что сведения о приложении настроены правильно.
2. По завершении нажмите кнопку **Создать**, чтобы добавить приложение в Intune.

    Отобразится колонка **Обзор** для бизнес-приложения.

Теперь вы выполнили все действия для добавления приложения Win32 в Intune. Сведения о назначении и мониторинге приложений см. в статьях [Назначение приложений группам с помощью Microsoft Intune](apps-deploy.md) и [Отслеживание сведений о приложении и его назначениях с помощью Microsoft Intune](apps-monitor.md).

## <a name="delivery-optimization"></a>Оптимизация доставки

Клиенты Windows 10 версии 1709 и выше будут скачивать содержимое приложения Win32 Intune с помощью компонента оптимизации доставки на клиенте Windows 10. Оптимизация доставки включает возможности одноранговой доставки, включенные по умолчанию. Оптимизацию доставки можно настроить с помощью групповой политики и конфигурации устройств Intune. См. дополнительные сведения об [оптимизации доставки для Windows 10](https://docs.microsoft.com/windows/deployment/update/waas-delivery-optimization). 

> [!NOTE]
> Кроме того, можно установить сервер подключенного кэша Майкрософт в точках распространения Configuration Manager, чтобы кэшировать содержимое приложений Intune Win32. Дополнительные сведения см. в разделе [Поддержка для приложений Win32 Intune](https://docs.microsoft.com/configmgr/core/plan-design/hierarchy/microsoft-connected-cache#bkmk_intune) статьи "Подключенный кэш Майкрософт в Configuration Manager".

## <a name="install-required-and-available-apps-on-devices"></a>Установка необходимых и доступных приложений на устройства

Пользователям будут отображаться всплывающие уведомления Windows о необходимых и доступных установках приложений. На следующем рисунке показан пример всплывающего уведомления, где установка приложения будет завершена только после перезагрузки устройства. 

![Снимок экрана: всплывающие уведомления Windows для установки приложения](./media/apps-win32-app-management/apps-win32-app-08.png)    

На следующем рисунке уведомление сообщает пользователю, что на устройстве изменяются приложения.

![Снимок экрана с уведомлением о внесении изменений в приложение](./media/apps-win32-app-management/apps-win32-app-09.png)    

## <a name="set-win32-app-availability-and-notifications"></a>Настройка доступности и уведомлений для приложений Win32
Вы можете настроить время начала и крайний срок для установки приложения Win32. При наступлении указанной начальной даты управляющее расширение Intune скачает приложение и сохранит его в кэше. При наступлении крайнего срока приложение будет установлено. Для доступных приложений время начала будет определять появление приложения на Корпоративном портале, а загрузка содержимого будет начинаться, когда пользователь запросит это приложение на Корпоративном портале. Кроме того, вы можете задать период отсрочки до перезапуска. 

Настройте дату и время доступности для выбранного приложения, выполнив следующие действия:

1. Войдите в [центр администрирования диспетчера конечных точек (Майкрософт)](https://go.microsoft.com/fwlink/?linkid=2109431).
2. Выберите **Приложения** > **Все приложения**.
3. Выберите из списка существующее **Приложение Windows (Win32)** . 
4. В области приложения выберите **Свойства** > **Изменить** рядом с разделом **Назначения** > **Добавить группу** под типом назначения **Требуется**. 
   Обратите внимание, что доступность приложения может зависеть от типа назначения. В списке **Тип назначения** можно выбрать **Требуется**, **Доступно для зарегистрированных устройств** или **Удалить**.
5. Выберите группу на панели **Выбор группы**, чтобы указать группу пользователей для назначения приложению. 

    > [!NOTE]
    > Для параметра **Тип назначения** доступны следующие варианты:<br>
    > - **Обязательное**. Вы можете **сделать это приложение обязательным для всех пользователей** и (или) **сделать это приложение обязательным на всех устройствах**.<br>
    > - **Available for enrolled devices** (Доступно для зарегистрированных устройств). Есть также вариант **Сделать это приложение доступным для всех пользователей с зарегистрированными устройствами**.<br>
    > - **Удалить**. Вы можете **удалить это приложение у всех пользователей** и (или) **удалить это приложение со всех устройств**.

6. Чтобы изменить параметры **Уведомления для конечных пользователей**, выберите **Показывать все всплывающие уведомления**.
7. На панели **Изменение назначения** установите для параметра **Ender user notifications** (Уведомления для конечных пользователей) значение **Показывать все всплывающие уведомления**. Обратите внимание, что для параметра **Уведомления для конечных пользователей** доступны варианты **Показывать все всплывающие уведомления**, **Показывать всплывающие уведомления о перезапуске компьютера** или **Скрывать все всплывающие уведомления**.
8. Задайте для параметра **Доступность приложения** значение **Конкретные дата и время**, затем выберите дату и время. Эти дата и время определяют, когда приложение будет загружено на устройство конечного пользователя. 
9. Задайте для параметра **Крайний срок установки приложения** значение **Конкретные дата и время**, затем выберите дату и время. Эти дата и время определяют, когда приложение будет установлено на устройстве конечного пользователя. Если для одного и того же пользователя или устройства установлено несколько назначений, выбирается самый ранний крайний срок установки приложения из всех возможных.

10. Щелкните **Включено** рядом с параметром **Период отсрочки до перезапуска**. Период отсрочки до перезапуска начинается сразу после завершения установки приложения на устройстве. Если этот параметр отключен, устройство может перезапуститься без предупреждения. <br>Здесь можно настроить следующие варианты:
    - **Период отсрочки до перезапуска устройства (в минутах)** . Значение по умолчанию — 1440 минут (24 часа). Допускаются значения не более 2 недель.
    - **Выберите, когда следует отображать диалоговое окно обратного отсчета перед перезапуском (в минутах)** . Значение по умолчанию — 15 минут.
    - **Разрешить пользователю отложить уведомление о перезапуске**. Здесь можно выбрать значение **Да** или **Нет**.
        - **Выберите, на сколько отложить (в минутах)** . Значение по умолчанию — 240 минут (4 часа). Это значение не может быть больше, чем период отсрочки до перезапуска.

11. Щелкните **Проверить и сохранить**.

## <a name="toast-notifications-for-win32-apps"></a>Всплывающие уведомления для приложений Win32 
При необходимости вы можете настроить игнорирование пользовательских всплывающих уведомлений пользователя для каждого назначения приложения. В Intune выберите **Приложения** > **Все приложения**, выберите приложение и **Назначения** > **Включить группы**. 

> [!NOTE]
> Приложения Win32, установленные с помощью расширения управления Intune, не будут удалены на незарегистрированных устройствах. Администраторы могут использовать исключение назначения, чтобы не предлагать установку приложений Win32 на устройствах BYOD.

## <a name="troubleshoot-win32-app-issues"></a>Устранение неполадок приложений Win32
Журналы агентов на клиентском компьютере обычно находятся в папке `C:\ProgramData\Microsoft\IntuneManagementExtension\Logs`. Для просмотра этих файлов журналов можно использовать `CMTrace.exe`. Дополнительные сведения см. в статье [CMTrace](https://docs.microsoft.com/configmgr/core/support/cmtrace).

![Снимок экрана: журналы агентов на клиентском компьютере](./media/apps-win32-app-management/apps-win32-app-10.png)    

> [!IMPORTANT]
> Чтобы обеспечить правильную установку и выполнение бизнес-приложений Win32, в параметрах защиты от вредоносного ПО следует исключить из проверки указанные далее каталоги.<p>
> **На клиентских компьютерах X64**:<br>
> *C:\Program Files (x86)\Microsoft Intune Management Extension\Content*<br>
> *C:\windows\IMECache*
>  
> **На клиентских компьютерах X86**:<br>
> *C:\Program Files\Microsoft Intune Management Extension\Content*<br>
> *C:\windows\IMECache*

### <a name="detecting-the-win32-app-file-version-using-powershell"></a>Обнаружение версии файла Win32 приложения с помощью PowerShell

Если вам не удается определить версию файла Win32 приложения, рекомендуется использовать или адаптировать следующую команду PowerShell:

``` PowerShell

$FileVersion = [System.Diagnostics.FileVersionInfo]::GetVersionInfo("<path to binary file>").FileVersion
#The below line trims the spaces before and after the version name
$FileVersion = $FileVersion.Trim();
if ("<file version of successfully detected file>" -eq $FileVersion)
{
#Write the version to STDOUT by default
$FileVersion
exit 0
}
else
{
#Exit with non-zero failure code
exit 1
}
```

В приведенной выше команде PowerShell замените `<path to binary file>` на путь к файлу приложения Win32. Путь будет аналогичен приведенному ниже:<br>
`C:\Program Files (x86)\Microsoft SQL Server Management Studio 18\Common7\IDE\ssms.exe`

Кроме того, замените `<file version of successfully detected file>` на версию файла, которую необходимо обнаружить. Пример строки версии файла будет аналогичен следующему:<br>
`2019.0150.18118.00 ((SSMS_Rel).190420-0019)`

Если вам нужно получить сведения о версии приложения Win32, можно использовать следующую команду PowerShell:

``` PowerShell

[System.Diagnostics.FileVersionInfo]::GetVersionInfo("<path to binary file>").FileVersion

```

В приведенной выше команде PowerShell замените `<path to binary file>` на путь к файлу.

### <a name="additional-troubleshooting-areas-to-consider"></a>Другие области устранения неполадок, на которые следует обратить внимание
- Проверьте конечные объекты, чтобы убедиться, что агент установлен на устройстве — приложение Win32, предназначенное группе, или скрипт PowerShell, предназначенный группе, будет создавать политику установки агента для группы безопасности.
- Проверьте версию ОС — Windows 10 версии 1607 и более поздних версий.  
- Проверьте номер SKU Windows 10 — Windows 10 S, или версии Windows, работающие с включенным режимом S-режиме, не поддерживают установку MSI.

Дополнительные сведения об устранении неполадок, связанных с установкой приложений Win32, см. в разделе [Устранение проблем с установкой приложений Win32](troubleshoot-app-install.md#win32-app-installation-troubleshooting).

## <a name="next-steps"></a>Дальнейшие шаги

- Дополнительные сведения о добавлении приложений в Intune см. в разделе [Добавление приложений в Microsoft Intune](apps-add.md).
