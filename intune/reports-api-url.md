---
title: Конечная точка API для хранилища данных Intune
titlesuffix: Microsoft Intune
description: В этой справочной статье описывается структура URL-адресов API хранилища данных Intune.
keywords: Хранилище данных Intune
author: Erikre
ms.author: erikre
manager: dougeby
ms.date: 07/25/2018
ms.topic: reference
ms.prod: ''
ms.service: microsoft-intune
ms.technology: ''
ms.assetid: A7A174EC-109D-4BB8-B460-F53AA2D033E6
ms.reviewer: aanavath
ms.suite: ems
ms.custom: intune-classic
ms.openlocfilehash: 05251e3aeb0c290a51c378f8c67f3d55149b63dc
ms.sourcegitcommit: e6013abd9669ddd0d6449f5c129d5b8850ea88f3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/25/2018
ms.locfileid: "39254507"
---
# <a name="intune-data-warehouse-api-endpoint"></a>Конечная точка API для хранилища данных Intune

Вы можете использовать API хранилища данных Intune с помощью учетной записи, используя определенные меры управления доступом на основе ролей и учетные данные Azure AD. Позднее вы авторизуете свой клиент REST с помощью Azure AD, используя OAuth 2.0. Наконец, вы сформируете значимый URL-адрес для вызова ресурса хранилища данных.

[!INCLUDE [reports-credential-reqs](./includes/reports-credential-reqs.md)]

## <a name="authorization"></a>Авторизация

Azure Active Directory (Azure AD) использует OAuth 2.0, чтобы предоставить возможность санкционировать доступ к веб-приложениям и веб-API в клиенте Azure AD. Это руководство не привязано к конкретному языку и описывает отправку и получение сообщений HTTP без использования библиотек с открытым исходным кодом. Поток кода проверки подлинности OAuth 2.0 описан в [разделе 4.1](https://tools.ietf.org/html/rfc6749#section-4.1) спецификации OAuth 2.0.

Дополнительные сведения см. в разделе [Разрешение доступа к веб-приложениям с помощью OAuth 2.0 и Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-protocols-oauth-code).

## <a name="api-url-structure"></a>Структура URL-адресов API

Конечные точки API для хранилища данных считывают сущности для каждого набора. API поддерживает команду **GET** HTTP и подмножество параметров запроса.

URL-адрес для Intune использует следующий формат:  
`https://fef.{location}.manage.microsoft.com/ReportingService/DataWarehouseFEService/{entity-collection}?api-version={api-version}`

> [!NOTE]
> В приведенном выше URL-адресе замените `{location}`, `{entity-collection}` и `{api-version}` на основании сведений, приведенных в таблице ниже.

URL-адрес содержит следующие элементы:

| Элемент | Пример | Описание |
|-------------------|------------|--------------------------------------------------------------------------------------------------------------------|
| местоположение | msua06 | Базовый URL-адрес можно узнать, просмотрев колонку API хранилища данных на портале Azure. |
| entity-collection | dates | Имя коллекции сущностей OData. Дополнительные сведения о коллекциях и сущностях в модели данных см. в разделе [Модели данных](reports-ref-data-model.md). |
| api-version | beta | Версия API, используемого для доступа. Дополнительные сведения см. в разделе [Версия](#API-version-information). |
| maxhistorydays | 7 | Максимальное число дней хранения журнала для извлечения (необязательно). Этот параметр может быть задан для любой коллекции, но будет действовать только для коллекций, которые содержат `dateKey` как часть свойства ключа. Дополнительную информацию см. в разделе [Фильтры диапазона DateKey](reports-api-url.md#datekey-range-filters). |

## <a name="api-version-information"></a>Сведения о версии API

Текущая версия API: `beta`. 

## <a name="odata-query-options"></a>Параметры запроса OData

Текущая версия поддерживает следующие параметры запроса OData: `$filter, $orderby, $select, $skip,` и `$top`.

## <a name="datekey-range-filters"></a>Фильтры диапазона DateKey

Фильтры диапазона `DateKey` могут использоваться для ограничения объема данных для загрузки для некоторых коллекций с `dateKey` в качестве свойства ключа. Фильтр `DateKey` можно использовать для оптимизации производительности службы путем предоставления следующего параметра запроса `$filter`:

1.  `DateKey` в `$filter`, используемый отдельно или поддерживающий операторы `lt/le/eq/ge/gt` и присоединяемый к ним с помощью логического оператора `and`, обеспечивает сопоставление с датой начала и (или) датой окончания.
2.  `maxhistorydays` передается как пользовательский параметр запроса.<br>

## <a name="filter-examples"></a>Примеры фильтров

> [!NOTE]
> В примерах фильтра подразумевается, что сегодняшняя дата — 21.02.2018.

|                             Filter                             |           Оптимизация производительности           |                                          Описание                                          |
|:--------------------------------------------------------------:|:--------------------------------------------:|:---------------------------------------------------------------------------------------------:|
|    `maxhistorydays=7`                                            |    Полная проверка                                      |    Возврат данных с `DateKey` из промежутка между 20180214 и 20180221.                                     |
|    `$filter=DateKey eq 20180214`                                 |    Полная проверка                                      |    Возврат данных с `DateKey`, равным 20180214.                                                    |
|    `$filter=DateKey ge 20180214 and DateKey lt 20180221`         |    Полная проверка                                      |    Возврат данных с `DateKey` из промежутка между 20180214 и 20180220.                                     |
|    `maxhistorydays=7&$filter=Id gt 1`                            |    Частичная, Id gt 1 не оптимизируется    |    Возврат данных с `DateKey` из промежутка между 20180214 и 20180221 при значении Id больше 1.             |
|    `maxhistorydays=7&$filter=DateKey eq 20180214`                |    Полная проверка                                      |    Возврат данных с `DateKey`, равным 20180214. `maxhistorydays` игнорируется.                            |
|    `$filter=DateKey eq 20180214 and Id gt 1`                     |    Нет                                      |    Не обрабатывается как фильтр диапазона `DateKey`, следовательно, производительность не повышается.                              |
|    `$filter=DateKey ne 20180214`                                 |    Нет                                      |    Не обрабатывается как фильтр диапазона `DateKey`, следовательно, производительность не повышается.                              |
|    `maxhistorydays=7&$filter=DateKey eq 20180214 and Id gt 1`    |    Нет                                      |    Не обрабатывается как фильтр диапазона `DateKey`, следовательно, производительность не повышается. `maxhistorydays` игнорируется.    |
