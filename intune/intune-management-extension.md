---
title: Добавление скриптов PowerShell в Microsoft Intune для устройств Windows 10 — Azure | Документы Майкрософт
description: Добавьте скрипты PowerShell, назначьте политику скриптов группам Azure Active Directory, используйте отчеты для отслеживания скриптов и ознакомьтесь с инструкциями по удалению скриптов, добавленных на устройствах Windows 10 в Microsoft Intune.
keywords: ''
author: MandiOhlinger
ms.author: mandia
manager: dougeby
ms.date: 11/28/2018
ms.topic: article
ms.prod: ''
ms.service: microsoft-intune
ms.technology: ''
ms.assetid: 768b6f08-3eff-4551-b139-095b3cfd1f89
ms.reviewer: ''
ms.suite: ems
search.appverid: MET150
ms.custom: intune-azure
ms.openlocfilehash: 2c4fb7000d808d860494d2af572c821b42fa6d5c
ms.sourcegitcommit: 77a1047f5d93c1924e5c9ea243454532881be031
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2018
ms.locfileid: "52579189"
---
# <a name="manage-powershell-scripts-in-intune-for-windows-10-devices"></a>Управление сценариями PowerShell в Intune для устройств Windows 10
Расширение управления Intune позволяет отправлять сценарии PowerShell в Intune для выполнения на устройствах Windows 10. Расширение управления дополняет возможности управления мобильными устройствами (MDM) Windows 10 и упрощает переход на современные принципы управления.

## <a name="moving-to-modern-management"></a>Переход на современные принципы управления
Вычислительная среда конечного пользователя находится на этапе цифрового преобразования. Классические ИТ-системы работают по схеме, где используется одна платформа для устройств, применяются корпоративные устройства, пользователи занимаются своими обязанностями в офисе, а множество ИТ-процессов выполняется вручную и в реактивном режиме. Но современные организации стремятся перейти на поддержку нескольких платформ как для личных, так и для корпоративных устройств, предоставить пользователям возможность работать из любого места и организовать автоматизированные и функционирующие в упреждающем режиме ИТ-процессы. 

Службы MDM, такие как Microsoft Intune, могут управлять устройствами Windows 10 с помощью протокола MDM. Встроенный клиент управления Windows 10 поддерживает возможности взаимодействия с Intune для реализации задач управления предприятием. Все это упрощает переход к принципам современного управления на устройствах Windows 10. Но вам могут потребоваться некоторые возможности, например расширенная конфигурация устройств, которая сейчас недоступна во встроенных функциях MDM Windows 10.

Расширение управления Intune дополняет встроенные возможности Windows 10 MDM. Можно создать сценарии PowerShell для запуска на устройствах Windows 10, предоставляющих нужную функциональность. Вы можете создать сценарий PowerShell, который настраивает пользовательские параметры, отправить его в Intune, назначить группе Azure Active Directory (AD) и запустить на устройствах с ОС Windows 10. После можно отслеживать состояние выполнения сценария на устройствах с ОС Windows 10 от начала до конца.

## <a name="prerequisites"></a>Предварительные условия
Для расширения управления Intune требуется выполнить следующие условия:
- Устройства должны быть присоединены к Azure AD. Расширение управления Intune поддерживает совместно управляемые зарегистрированные устройства Windows, а также устройства, присоединенные к Azure Active Directory или гибридному домену.
- Устройства должны работать под управлением Windows 10 версии 1607 или более поздней.
- Автоматическая регистрация в системе MDM должна быть [включена в Azure AD](https://docs.microsoft.com/intune/windows-enroll#enable-windows-10-automatic-enrollment), и устройства должны автоматически регистрироваться в Intune.

## <a name="create-a-powershell-script-policy"></a>Создание политики сценария PowerShell 
1. Войдите на [портал Azure](https://portal.azure.com).
2. Выберите **Все службы**, отфильтруйте список по **Intune** и выберите **Microsoft Intune**.
3. Выберите **Конфигурация устройства** > **Скрипты PowerShell** > **Добавить**.
4. Введите **имя** и **описание** скрипта PowerShell. В поле **Расположение скрипта** укажите скрипт PowerShell. Размер скрипта должен быть меньше 200 КБ (ASCII) или 100 КБ (Юникод).
5. Выберите **Настройка**. Затем решите, следует ли выполнять скрипт с учетными данными пользователя на устройстве (**Да**) или в контексте системы (**Нет**). По умолчанию сценарий выполняется в контексте системы. Выберите **Да**, если сценарий не требуется запускать в контексте системы. 
  ![Панель добавления сценария PowerShell](./media/mgmt-extension-add-script.png)
6. Выберите, должен ли скрипт быть подписан доверенным издателем (**Да**). По умолчанию требование к подписыванию сценария отсутствует. 
7. Нажмите кнопку **ОК**, а затем **Создать**, чтобы сохранить скрипт.

## <a name="assign-a-powershell-script-policy"></a>Назначение политики сценария PowerShell
1. В области **Скрипты PowerShell** выберите скрипт для назначения, а затем выберите пункты **Управление** > **Назначения**.
  ![Панель добавления сценария PowerShell](./media/mgmt-extension-assignments.png)
 
2. Щелкните **Выбрать группы**, чтобы открыть список доступных групп Azure AD. 
3. Выберите одну или несколько групп пользователей, чьи устройства получат скрипт. Нажмите **Выбрать**, чтобы назначить политику выбранным группам.

> [!NOTE]
> - Конечным пользователям не требуется выполнять вход на устройство для выполнения сценариев PowerShell. 
> - Сценарии PowerShell в Intune могут быть нацелены на группы безопасности устройств AAD.

Расширение управления Intune синхронизируется с Intune каждый час. После назначения политики группам Azure AD выполняется скрипт PowerShell, после чего выводятся результаты выполнения. 
 
## <a name="monitor-run-status-for-powershell-scripts"></a>Отслеживание состояния выполнения сценариев PowerShell
На портале Azure можно отслеживать состояние выполнения сценариев PowerShell для пользователей и устройств.

В области **Скрипты PowerShell** выберите скрипт для отслеживания, а затем **Монитор** и один из следующих отчетов:
   - **Состояние устройства**
   - **Состояние пользователя**

## <a name="troubleshoot-powershell-scripts"></a>Устранение неполадок со скриптами PowerShell

Журналы агентов на клиентском компьютере обычно находятся в папке `\ProgramData\Microsoft\IntuneManagementExtension\Logs`. Для просмотра этих файлов журналов можно использовать [CMTrace.exe](https://docs.microsoft.com/sccm/core/support/tools). 

![Снимок экрана. Журналы агентов](./media/apps-win32-app-10.png)  

## <a name="delete-a-powershell-script"></a>Удаление скрипта PowerShell
В области **Скрипты PowerShell** щелкните скрипт правой кнопкой мыши и выберите пункт **Удалить**.
